<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê´€ê´‘ì§€ ì¶”ì²œ</title>
    <!-- jQuery íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸° -->
    <script src="./js/jquery-3.7.0.js"></script>
    <style>

    </style>
</head>
<!-- kakao map api key :
         7ec543a606068b69b800c740856e21ed -->

<body>
    <div id="map" style="width:100%;height:350px;"></div>
    <button id="getGjBtn">ê´‘ì£¼ ê´€ê´‘ì§€ ê°€ì ¸ì˜¤ê¸°</button>
    <button id="randomGjBtn" style="display: none;">ì˜¤ëŠ˜ì˜ ê´€ê´‘ì§€ ì¶”ì²œ!</button>
    <div id='randomContainer'></div>
    <script type="text/javascript"
    src="//dapi.kakao.com/v2/maps/sdk.js?appkey=7ec543a606068b69b800c740856e21ed"></script>
    <script>
        

        // ë§ˆì»¤ë¥¼ í‘œì‹œí•  ìœ„ì¹˜ì™€ title ê°ì²´ ë°°ì—´ì…ë‹ˆë‹¤ 
        let positions = [
            {
                title: 'ê´‘ì£¼ ì¸ê³µì§€ëŠ¥ ì‚¬ê´€í•™êµ',
                latlng: new kakao.maps.LatLng(35.1466, 126.9224)
            },
            {
                title: 'KT êµ¬ë‚´ì‹ë‹¹',
                latlng: new kakao.maps.LatLng(35.1465, 126.9237)
            },
            {
                title: 'ê¶ì „ì œê³¼',
                latlng: new kakao.maps.LatLng(35.1477, 126.9179)
            }
        ]

        
        const makeMap = (lat, lng, lv) => {
            console.log('55');
            let mapContainer = document.getElementById('map'), // ì§€ë„ë¥¼ í‘œì‹œí•  div  
            mapOption = {
                center: new kakao.maps.LatLng(lat, lng), // ì§€ë„ì˜ ì¤‘ì‹¬ì¢Œí‘œ
                level: lv // ì§€ë„ì˜ í™•ëŒ€ ë ˆë²¨
            };
            let map = new kakao.maps.Map(mapContainer, mapOption); // ì§€ë„ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
            // ë§ˆì»¤ ì´ë¯¸ì§€ì˜ ì´ë¯¸ì§€ ì£¼ì†Œì…ë‹ˆë‹¤
            var imageSrc = "https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/markerStar.png";

            for (var i = 0; i < positions.length; i++) {

                // ë§ˆì»¤ ì´ë¯¸ì§€ì˜ ì´ë¯¸ì§€ í¬ê¸° ì…ë‹ˆë‹¤
                var imageSize = new kakao.maps.Size(24, 35);

                // ë§ˆì»¤ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤    
                var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize);

                // ë§ˆì»¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
                var marker = new kakao.maps.Marker({
                    map: map, // ë§ˆì»¤ë¥¼ í‘œì‹œí•  ì§€ë„
                    position: positions[i].latlng, // ë§ˆì»¤ë¥¼ í‘œì‹œí•  ìœ„ì¹˜
                    title: positions[i].title, // ë§ˆì»¤ì˜ íƒ€ì´í‹€, ë§ˆì»¤ì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ íƒ€ì´í‹€ì´ í‘œì‹œë©ë‹ˆë‹¤
                    image: markerImage // ë§ˆì»¤ ì´ë¯¸ì§€ 
                });
            }

        }

        /*
        ê´‘ì£¼ ê´€ê´‘ì§€ ê°€ì ¸ì˜¤ê¸° ë²„íŠ¼ì„ í´ë¦­ì‹œ, consoleì°½ì— ê´‘ì£¼ ê´€ê´‘ì§€ ë°ì´í„°ê°€ ëœ¨ë„ë¡í•  ê²ƒ
        jQuery + ajax 
        =>ex07_ë¹„ë™ê¸°í†µì‹ .html ì°¸ê³ 
        => ì™„ë£Œì‹œ ì½˜ì†” ìº¡ì³í•´ ë‹¨í†¡ë°© ì—…ë¡œë“œ
        */

        const getTourList = () => {
            let openAPI_URL = "http://apis.data.go.kr/6290000/tourdestbaseinfo/gettourdestbaseinfo?serviceKey=DqCkN9GvHi1TU9OmabMk%2BdPD2hZLQ%2FzqNTdtsubgj6x%2Bs3U9hb1IhZDNO6ny6yDHVYS%2FDsebOIolzXWcxL2o4A%3D%3D&type=json&pageNo=1&numOfRows=80"
            $('#randomGjBtn').css('display',"")

            $.ajax({
                url: openAPI_URL,
                success: (result) => {
                    alert('ìš”ì²­ì„±ê³µğŸ˜€');
                    console.log(result);
                    console.log(result.TourDestBaseInfo)

                    // ë°ì´í„° ì•ˆì— í¬í•¨ë˜ì–´ ìˆëŠ” 83ê°œì˜ ë°ì´í„°ë¥¼ positionsë¼ëŠ” ë°°ì—´ì— ì¶”ê°€
                    for (let i = 0; i < result.TourDestBaseInfo.length; i++) {
                        console.log(result.TourDestBaseInfo)
                        console.log(result.TourDestBaseInfo[i].tourDestNm
                            , result.TourDestBaseInfo[i].lat,
                            result.TourDestBaseInfo[i].lng)

                        positions.push({
                            title: result.TourDestBaseInfo[i].tourDestNm,
                            latlng: new kakao.maps.LatLng(result.TourDestBaseInfo[i].lat, result.TourDestBaseInfo[i].lng)
                        })
                    }
                    console.log('positions : ', positions)
                    makeMap(35.1465, 126.9222, 8)
                    
                },
                error: () => {
                    alert("ìš”ì²­ì‹¤íŒ¨ğŸ˜¥")
                }



            });
        }

        $('#getGjBtn').on("click", getTourList)
        $('#randomGjBtn').on("click", ()=>{
            //1.ëœë¤í•œ ìˆ˜ë¥¼ í•˜ë‚˜ ë½‘ì•„ë‚¼ ê²ƒ(ranNum)
            let ranNum = Math.random()*positions.length
            console.log('ranNum',ranNum);
        //  0ë¶€í„°~ë°°ì—´ì˜ ê¸¸ì´ë§Œí¼
        //2. ë²„íŠ¼ ë°‘ì— h2íƒœê·¸ë¡œ ì˜¤ëŠ˜ì˜ ì¶”ì²œ ê´€ê´‘ì§€ëŠ” ~ì…ë‹ˆë‹¤.
        $('#randomContainer').html(`<h2>ì˜¤ëŠ˜ì˜ ì¶”ì²œ ê´€ê´‘ì§€ëŠ” ${positions[ranNum].title}ì…ë‹ˆë‹¤.</h2>`)
        makeMap(positions[ranNum].latlng.Ma,positions[ranNum].latlng.La,3)
        //3. í•´ë‹¹ ì¶”ì²œ ê´€ê´‘ì§€ê°€ ë³´ì´ë„ë¡ mapì„ ë‹¤ì‹œ ì„¤ì •
        })



    </script>
</body>

</html>